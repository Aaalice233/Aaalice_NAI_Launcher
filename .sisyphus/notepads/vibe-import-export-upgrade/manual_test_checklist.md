# Vibe Import/Export 手动验证清单

> 本文档记录 Vibe 导入导出功能的完整手动测试场景。

---

## 测试数据准备

### 文件位置
所有测试文件应放置在 `test/fixtures/vibe_samples/` 目录下。

### 测试文件类型

#### 1. 图片文件（用于 Embed Vibe）
- **要求**: PNG 或 JPEG 格式
- **建议尺寸**: 512x512 或更大
- **命名示例**: `test_character.png`, `test_style.jpg`
- **用途**: 测试从图片直接导入 Vibe

#### 2. Bundle 文件（.naiv4vibe）
- **创建方式**: 从应用内导出单个或多个 Vibe
- **命名示例**: `single_vibe.naiv4vibe`, `multi_vibes.naiv4vibe`
- **用途**: 测试 Bundle 导入导出

#### 3. 损坏/无效文件
- **损坏图片**: 截断的 PNG 文件
- **错误格式**: 修改扩展名的文本文件（如 `fake.png`）
- **空文件**: 0 字节的 .naiv4vibe 文件
- **用途**: 测试错误处理

---

## 测试场景清单

### 测试场景 1: 单个 Vibe 导出为 Bundle

**前置条件**: 应用中已创建至少一个 Vibe

- [ ] 步骤 1: 在 Vibe 列表中选择一个 Vibe
- [ ] 步骤 2: 点击导出按钮，选择 "Export Bundle" 选项
- [ ] 步骤 3: 选择保存位置并确认

**期望结果**:
- [ ] 成功导出 `.naiv4vibe` 文件
- [ ] 文件大小合理（包含元数据）
- [ ] 导出过程中显示进度指示

**验证方法**:
- [ ] 使用文件管理器检查导出的文件存在
- [ ] 尝试在测试场景 4 中导入该文件

---

### 测试场景 2: 单个 Vibe 嵌入图片

**前置条件**: 应用中已创建至少一个 Vibe

- [ ] 步骤 1: 在 Vibe 列表中选择一个 Vibe
- [ ] 步骤 2: 点击导出按钮，选择 "Embed to Image" 选项
- [ ] 步骤 3: 选择原始图片（PNG/JPEG）
- [ ] 步骤 4: 选择保存位置并确认

**期望结果**:
- [ ] 成功生成包含 Vibe 元数据的图片
- [ ] 图片视觉上与原始图片一致
- [ ] 文件大小增加（包含嵌入数据）

**验证方法**:
- [ ] 使用图片查看器确认图片正常显示
- [ ] 尝试在测试场景 5 中从该图片导入 Vibe

---

### 测试场景 3: 批量 Vibe 导出

**前置条件**: 应用中已创建至少 3 个 Vibe

- [ ] 步骤 1: 进入 Vibe 列表，启用多选模式
- [ ] 步骤 2: 选择多个 Vibe（至少 2 个）
- [ ] 步骤 3: 点击批量导出按钮
- [ ] 步骤 4: 选择保存位置并确认

**期望结果**:
- [ ] 成功导出一个包含所有选中 Vibe 的 `.naiv4vibe` 文件
- [ ] 批量导出对话框显示选中的 Vibe 数量
- [ ] 导出进度正确显示

**验证方法**:
- [ ] 导出完成后，在测试场景 4 中导入并验证所有 Vibe 都存在

---

### 测试场景 4: 从 Bundle 导入

**前置条件**: 已有测试用的 `.naiv4vibe` 文件

- [ ] 步骤 1: 在 Vibe 列表页面点击导入按钮
- [ ] 步骤 2: 选择 `.naiv4vibe` 文件
- [ ] 步骤 3: 确认导入（如果有预览对话框）

**期望结果**:
- [ ] 成功解析 Bundle 文件
- [ ] 显示预览（包含 Vibe 名称、数量）
- [ ] 导入后 Vibe 列表正确更新
- [ ] 导入的 Vibe 数据完整（名称、提示词、设置等）

**验证方法**:
- [ ] 检查导入的 Vibe 名称是否正确
- [ ] 打开 Vibe 详情，验证所有字段完整
- [ ] 尝试使用导入的 Vibe 进行图像生成

---

### 测试场景 5: 从图片导入

**前置条件**: 已有包含嵌入 Vibe 的图片文件

- [ ] 步骤 1: 在 Vibe 列表页面点击导入按钮
- [ ] 步骤 2: 选择包含 Vibe 的图片文件
- [ ] 步骤 3: 确认导入

**期望结果**:
- [ ] 成功从图片中提取 Vibe 元数据
- [ ] 显示提取的 Vibe 信息预览
- [ ] 导入后 Vibe 正确添加到列表

**验证方法**:
- [ ] 检查导入的 Vibe 与原始 Vibe 数据一致
- [ ] 验证图片中的 Vibe 设置完整保留

---

### 测试场景 6: 拖拽多种格式文件导入

**前置条件**: 准备多种格式的测试文件（.naiv4vibe、含 Vibe 的图片、普通图片）

- [ ] 步骤 1: 打开文件管理器，选择多个文件
- [ ] 步骤 2: 拖拽文件到应用的 Vibe 列表区域
- [ ] 步骤 3: 观察导入行为

**期望结果**:
- [ ] 支持同时拖拽多个文件
- [ ] 正确识别每种文件类型
- [ ] Bundle 文件正常导入
- [ ] 含 Vibe 的图片正常提取
- [ ] 普通图片（不含 Vibe）显示适当提示
- [ ] 批量导入进度正确显示

**验证方法**:
- [ ] 检查所有有效文件都成功导入
- [ ] 检查无效文件有错误提示

---

### 测试场景 7: 编码导出和导入（Vibe Transfer）

**前置条件**: 应用中已创建 Vibe 并配置编码选项

- [ ] 步骤 1: 选择一个 Vibe，配置编码参数（Strength、Fidelity 等）
- [ ] 步骤 2: 导出为 Bundle（包含编码信息）
- [ ] 步骤 3: 清除当前 Vibe 或切换到新环境
- [ ] 步骤 4: 导入刚才导出的 Bundle
- [ ] 步骤 5: 检查编码设置

**期望结果**:
- [ ] 编码参数（Strength、Fidelity）正确保存
- [ ] 导入后编码设置与导出时一致
- [ ] Vibe Transfer 功能正常工作

**验证方法**:
- [ ] 对比导出前后的编码参数
- [ ] 使用导入的 Vibe 进行图像生成，验证效果一致

---

### 测试场景 8: 错误处理（损坏文件、不支持格式）

**前置条件**: 准备以下测试文件：
- 损坏的 PNG 文件（截断）
- 修改扩展名的文本文件（如 `fake.png`）
- 空的 `.naiv4vibe` 文件
- 旧版本的 Bundle 文件
- 超大文件（>100MB）

- [ ] 步骤 1: 尝试导入损坏的 PNG 文件
- [ ] 步骤 2: 尝试导入伪装的图片文件
- [ ] 步骤 3: 尝试导入空的 Bundle 文件
- [ ] 步骤 4: 尝试导入旧版本 Bundle（如适用）
- [ ] 步骤 5: 尝试导入超大文件

**期望结果**:
- [ ] 损坏的 PNG: 显示友好的错误提示（"无法读取图片文件"）
- [ ] 伪装文件: 显示格式不支持提示
- [ ] 空 Bundle: 显示文件损坏提示
- [ ] 旧版本 Bundle: 显示版本不兼容提示（或自动转换）
- [ ] 超大文件: 显示文件过大提示或处理超时

**验证方法**:
- [ ] 确认每个错误都有明确的错误信息
- [ ] 确认应用不会崩溃
- [ ] 确认用户可以重试或取消

---

## 性能测试（可选）

### 大规模 Vibe 导出
- [ ] 导出 50+ 个 Vibe
- [ ] 观察内存使用
- [ ] 验证导出时间合理

### 大规模导入
- [ ] 导入包含 50+ Vibe 的 Bundle
- [ ] 观察导入进度和内存使用
- [ ] 验证所有 Vibe 正确导入

---

## 跨平台兼容性测试

### Windows ↔ Android
- [ ] 在 Windows 导出 Vibe，在 Android 导入
- [ ] 在 Android 导出 Vibe，在 Windows 导入

### 文件路径特殊字符
- [ ] 导出到包含中文路径的目录
- [ ] 导出到包含空格的目录
- [ ] 导出到包含特殊字符的目录

---

## 测试完成检查

所有场景测试完成后：

- [ ] 所有测试场景已执行
- [ ] 发现的问题已记录
- [ ] 通过的测试已标记
- [ ] 失败的测试有详细说明

---

## 问题记录

| 问题描述 | 测试场景 | 严重程度 | 状态 |
|---------|---------|---------|------|
| | | | |

---

*最后更新: 2026-02-12*
