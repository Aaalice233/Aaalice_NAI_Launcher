!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="ea804e78-d7b5-4b24-9601-0a122dc325f9",e._sentryDebugIdIdentifier="sentry-dbid-ea804e78-d7b5-4b24-9601-0a122dc325f9")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1855],{91855:(e,t,n)=>{n.d(t,{EH:()=>X,HP:()=>O,KW:()=>Y,L4:()=>W,Nj:()=>H,WZ:()=>ee,h7:()=>et,kP:()=>q});var i=n(94458),s=n(97223),o=n(29415),a=n.n(o),r=n(68658),l=n(2380),c=n.n(l),d=n(27481),h=n(55805),u=n(9713),x=n(84601),p=n(73484),m=n(89077),g=n(92704),f=n(41879),j=n(84659),y=n(19058),b=n(35658),w=n(44531),v=n(83513),C=n(20645),F=n(88587),k=n(2834),A=n(73060),I=n(21715),T=n(89441).Buffer;function _(e){let{children:t,allowedExtensions:n,collection:o}=e,l=(0,p.B2)(),{capture:c}=(0,v.A)(),[h,A]=(0,k.fp)(s.do),[_,D]=(0,r.useState)(null),{submitImage:M,getUserImages:P,deleteImage:R}=O(o),U=async e=>{let t=e.name.slice(e.name.lastIndexOf(".")+1);return n.includes(t)?e.size>5e7?(0,d.oR)((0,I.LP)(l.common.maximumFileSize,{size:50})):A({...e}):(0,d.oR)(l.common.fileTypeNotSupported),!0},H=(0,k.md)(s.Nn),[W]=(0,r.useState)(!1),[G,q]=(0,r.useState)((0,x.cv)(H.settings,"penName")||""),[Y,Z]=(0,r.useState)(""),[J,K]=(0,r.useState)(""),[Q,V]=(0,r.useState)(""),[X,ee]=(0,r.useState)(""),[et,en]=(0,r.useState)(""),[ei,es]=(0,r.useState)(!0);(0,r.useEffect)(()=>{H.authenticated&&!H.noAccount&&(async()=>{let e=await P();e&&(e=e.filter(e=>e.collection_name===o),e?.length>0&&D(e[0]),es(!1))})()},[o,P,H.authenticated,H.noAccount]);let eo=(0,r.useRef)(null),ea=(0,r.useCallback)(()=>{if(!ei&&!W){if(!h||!G||!Q||!Y||h.size<=2||Q.length<=3||!Q.includes("@"))return void(0,d.oR)(l.contest.fillMandatoryFields);es(!0),ee(""),en(""),(async()=>{await M(T.from(h.buff).toString("base64"),G,Y,J,Q).then(e=>{c("anniversary_contest_2024_submission:submitted",{collection:o}),en(l.contest.submissionSuccess),D({name:e.name,title:Y,author:G,extra_context:J,email:Q}),setTimeout(()=>eo.current?.confetti({particleCount:100,spread:70,origin:{y:.6}}),200)}).catch(e=>{"Error extracting metadata, invalid NovelAI image. Make sure it's exported properly."===e?ee(l.contest.uploadFailedNoMetadata):"Error creating image: one image with user id already exists in collection"===e?ee(l.contest.uploadFailedDuplicate):ee((0,I.LP)(l.contest.uploadFailed,e))}).finally(()=>es(!1))})()}},[c,o,W,Q,J,h,ei,l.contest.fillMandatoryFields,l.contest.submissionSuccess,l.contest.uploadFailed,l.contest.uploadFailedDuplicate,l.contest.uploadFailedNoMetadata,G,M,Y]),er=(0,r.useRef)(()=>!1),[el]=(0,r.useState)(!0),ec=C.F;return el?(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(B,{style:{display:"flex",gap:10,alignItems:"center"},children:(0,i.jsx)("div",{children:(0,i.jsx)("span",{children:l.contest.votingClosed})})})}):!H.authenticated||H.noAccount?(0,i.jsxs)($,{children:[(0,i.jsx)(g.Qc$,{}),(0,i.jsxs)("span",{children:[l.contest.loginRequired[0]," ",(0,i.jsx)(a(),{href:"/login",legacyBehavior:!0,children:l.contest.loginRequired[1]}),l.contest.loginRequired[2]]})]}):(0,i.jsxs)(r.Fragment,{children:[ei&&(0,i.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:200,background:ec.colors.bg2},children:(0,i.jsx)(y.k,{visible:!0})}),!_&&!ei&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("h4",{children:l.contest.title}),(0,i.jsx)("p",{children:l.contest.titleSub}),(0,i.jsx)("input",{type:"text",name:"Title",value:Y,onChange:e=>Z(e.target.value),disabled:ei,maxLength:100}),(0,i.jsx)(f._C,{min:30,max:30}),(0,i.jsx)("h4",{children:l.contest.textFieldOptional}),(0,i.jsx)("p",{children:l.contest.textFieldSub}),(0,i.jsx)(w.A,{name:"Additional Information",value:J,onChange:e=>K(e.target.value),disabled:ei,minRows:3,maxRows:10,maxLength:2e3}),(0,i.jsx)(f._C,{min:30,max:30}),(0,i.jsx)("h4",{children:l.contest.name}),(0,i.jsx)("p",{children:l.contest.nameSub}),(0,i.jsx)("input",{type:"text",name:"Author Name",value:G,onChange:e=>q(e.target.value),disabled:ei,maxLength:100}),(0,i.jsx)(f._C,{min:30,max:30}),(0,i.jsx)("h4",{children:l.contest.email}),(0,i.jsx)("p",{children:l.contest.emailSub}),(0,i.jsx)("input",{type:"email",name:"Contact Email",value:Q,onChange:e=>V(e.target.value),disabled:ei,maxLength:100}),(0,i.jsx)(f._C,{min:30,max:30}),(0,i.jsx)(j.Ay,{overlay:j.NB.Fixed,button:j.fL.Direct,buttonClickRef:er,onImportFile:U,allowedFileTypes:[u.on.unknown],children:(0,i.jsxs)(N,{children:[(0,i.jsxs)(z,{children:[(0,i.jsx)("div",{children:l.contest.yourSubmission}),(0,i.jsx)("div",{children:l.contest.supportedFileTypes})]}),(0,i.jsx)(m.ur,{theme:ec,style:{flex:"1 1 auto",justifyContent:"center"},disabled:ei,onClick:()=>er.current(),children:l.contest.selectFile})]})}),(0,i.jsx)(f._C,{min:20,max:20})]}),_&&!ei&&(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:20,padding:20,background:ec.colors.bg2},children:[(0,i.jsxs)("div",{children:[et&&(0,i.jsx)("div",{style:{display:"flex",width:"100%",justifyContent:"center",paddingBottom:20},children:(0,i.jsxs)(E,{children:[(0,i.jsx)(S,{ref:eo}),(0,i.jsx)(g.Wdv,{style:{height:40,width:40}})," ",(0,i.jsx)("span",{children:et})]})}),(0,i.jsx)("h4",{style:{marginBottom:10},children:l.contest.currentSubmission}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("span",{style:{color:ec.colors.textHeadings},children:[l.contest.title," "]}),(0,i.jsx)("span",{children:_.title})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("span",{style:{color:ec.colors.textHeadings},children:[l.contest.name," "]}),(0,i.jsx)("span",{children:_.author})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("span",{style:{color:ec.colors.textHeadings},children:[l.contest.textField," "]}),(0,i.jsx)("span",{children:_.extra_context})]}),(0,i.jsx)(f._C,{min:20,max:20}),(0,i.jsx)("img",{src:`${F.e2.TinyExploreBackendUrl}/blob/${_.name}`,width:"100%",alt:"Preview"})]}),(0,i.jsxs)(m.ur,{theme:ec,disabled:ei,onClick:()=>{R(_.name).then(()=>{en(""),c("anniversary_contest_2024_submission:deleted",{collection:o}),D(null)})},style:{display:"flex",justifyContent:"center",alignItems:"center",gap:10,minHeight:40,color:ec.colors.warning},children:[(0,i.jsx)(b.d7,{theme:ec,style:{height:20,width:20,backgroundColor:ec.colors.warning}}),l.contest.deleteSubmission]})]}),!_&&h&&!ei&&(0,i.jsx)(L,{file:h,remove:()=>{A(null)}}),X&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(f._C,{min:20,max:20}),(0,i.jsxs)($,{children:[(0,i.jsx)(g.ejf,{style:{height:20,width:20},theme:ec}),(0,i.jsx)("span",{children:X})]})]}),!_&&!ei&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(f._C,{min:20,max:20}),(0,i.jsx)(m.WM,{theme:ec,style:{width:"100%"},disabled:W||ei,onClick:ea,children:l.contest.submit})]}),t]})}let S=(0,h.Ay)(c()).withConfig({componentId:"sc-42b64675-0"})(["position:absolute;max-width:unset;width:150px;height:300px;bottom:-120px;left:-60px;z-index:1000;&,& *{pointer-events:none !important;}"]),$=h.Ay.div.withConfig({componentId:"sc-42b64675-1"})(["color:",";padding:10px 0;display:flex;flex-direction:row;align-items:center;gap:10px;position:relative;"],e=>C.F.colors.warning),E=(0,h.Ay)($).withConfig({componentId:"sc-42b64675-2"})(["color:",";"],e=>C.F.colors.textHeadingsOptions[2]),B=h.Ay.span.withConfig({componentId:"sc-42b64675-3"})(["color:",";font-weight:600;"],e=>C.F.colors.textHeadings),N=h.Ay.div.withConfig({componentId:"sc-42b64675-4"})(["display:flex;flex-direction:row;width:100%;"]),z=h.Ay.div.withConfig({componentId:"sc-42b64675-5"})(["flex:10 1 auto;& > div:nth-child(1){font-size:16;font-weight:600;font-family:",";}& > div:nth-child(2){opacity:0.5;}"],e=>C.F.fonts.headings),D=h.Ay.div.withConfig({componentId:"sc-42b64675-6"})(["display:flex;flex-direction:column;gap:10px;padding:15px;background:",";"],e=>C.F.colors.bg0),M=h.Ay.div.withConfig({componentId:"sc-42b64675-7"})(["display:flex;flex-direction:row;flex-wrap:wrap;gap:10px;position:relative;overflow:hidden;padding:10px;background:",";"],e=>C.F.colors.bg2),P=h.Ay.div.withConfig({componentId:"sc-42b64675-8"})(["height:100px;min-width:100px;max-width:100%;border:1px solid ",";padding:4px;border-radius:3px;position:relative;pointer-events:none;display:flex;justify-content:center;align-items:center;flex:1;background:",";"],e=>C.F.colors.bg3,e=>C.F.colors.bg1),R=h.Ay.div.withConfig({componentId:"sc-42b64675-9"})(["padding:10px;display:flex;flex-direction:column;&::before{content:'Name';opacity:0.5;font-size:0.675;}flex:10;"]),U=h.Ay.div.withConfig({componentId:"sc-42b64675-10"})(["padding:5px;opacity:0.8;display:flex;align-items:center;cursor:pointer;&:hover{opacity:1;}"]);var H=function(e){return e.createdAt="created_at",e.likes="likes",e}({});function L(e){let{file:t,remove:n}=e,s=t?.name?.slice(t?.name?.lastIndexOf(".")+1),o=C.F;return(0,i.jsx)(D,{children:(0,i.jsxs)(M,{children:[(0,i.jsx)(P,{children:["gif","png","jpg","jpeg"].includes(s)&&t.buff.byteLength>5?(0,i.jsx)("img",{src:`data:image/${s};base64,${T.from(t.buff).toString("base64")}`,width:"100%",height:"100%",style:{maxWidth:"100%",objectFit:"contain"},alt:"Preview"}):(0,i.jsx)(g.$mk,{})}),(0,i.jsx)(R,{children:t.name}),(0,i.jsx)(U,{onClick:()=>n(),children:(0,i.jsx)(g.ejf,{theme:o})})]})})}let O=e=>{let t=(0,A.yF)((0,r.useCallback)(async(t,n,i,o,a,r,l)=>{let c=t(s.Nn);if(!c.authenticated)return;let d=await fetch(`${F.e2.TinyExploreBackendUrl}/image/${e}`,{mode:"cors",cache:"no-store",headers:{"Content-Type":"application/json",Authorization:"Bearer "+c.auth_token},method:"POST",body:JSON.stringify({blob:i,author:o,title:a,extra_context:r,email:l})}),h=await d.json();if(h.statusCode&&200!==h.statusCode)throw h.message||"Failed to submit image.";return h},[e])),n=(0,A.yF)((0,r.useCallback)(async(e,t,n)=>{let i=e(s.Nn);if(!i.authenticated)return;let o=await fetch(`${F.e2.TinyExploreBackendUrl}/image/${n}`,{mode:"cors",cache:"no-store",headers:{"Content-Type":"application/json",Authorization:"Bearer "+i.auth_token},method:"DELETE"});if(200!==o.status){if(404===o.status)return!0;throw"Failed to delete image."}return!0},[])),i=(0,A.yF)((0,r.useCallback)(async(e,t)=>{let n=e(s.Nn);if(!n.authenticated)return;let i=await fetch(`${F.e2.TinyExploreBackendUrl}/user/images?limit=10`,{mode:"cors",cache:"no-store",headers:{"Content-Type":"application/json",Authorization:"Bearer "+n.auth_token},method:"GET"}),o=await i.json();if(o.statusCode&&200!==o.statusCode)throw o.message||"Failed to get user images.";return o},[])),o=(0,A.yF)((0,r.useCallback)(async(e,t,n)=>{let i=e(s.Nn);if(!i.authenticated)return;let o=await fetch(`${F.e2.TinyExploreBackendUrl}/image/like/${n}`,{mode:"cors",cache:"no-store",headers:{"Content-Type":"application/json",Authorization:"Bearer "+i.auth_token},method:"GET"});if(200!==o.status)throw(await o.json()).message??"Failed to like image.";return!0},[])),a=(0,A.yF)((0,r.useCallback)(async(e,t,n)=>{let i=e(s.Nn);if(!i.authenticated)return;let o=await fetch(`${F.e2.TinyExploreBackendUrl}/image/unlike/${n}`,{mode:"cors",cache:"no-store",headers:{"Content-Type":"application/json",Authorization:"Bearer "+i.auth_token},method:"GET"});if(200!==o.status)throw(await o.json()).message??"Failed to unlike image.";return!0},[])),l=(0,A.yF)((0,r.useCallback)(async function(t,n){let i=!(arguments.length>2)||void 0===arguments[2]||arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"created_at",a=t(s.Nn);if(!a.authenticated)throw"Not authenticated.";let r=await fetch(`${F.e2.TinyExploreBackendUrl}/images/${e}?approved=${i}&sort_by=${o}`,{mode:"cors",cache:"no-store",headers:{"Content-Type":"application/json",Authorization:"Bearer "+a.auth_token},method:"GET"}),l=await r.json();if(l.statusCode&&200!==l.statusCode)throw"Failed to get collection images.";return l},[]));return{submitImage:t,getUserImages:i,deleteImage:n,likeImage:o,unlikeImage:a,getCollectionImages:l,approveImage:(0,A.yF)((0,r.useCallback)(async(e,t,n)=>{let i=e(s.Nn);if(!i.authenticated)return;let o=await fetch(`${F.e2.TinyExploreBackendUrl}/admin/approve/${n}`,{mode:"cors",cache:"no-store",headers:{"Content-Type":"application/json",Authorization:"Bearer "+i.auth_token},method:"PUT"});if(200!==o.status)throw(await o.json()).message??"Failed to approve image.";return!0},[])),unapproveImage:(0,A.yF)((0,r.useCallback)(async(e,t,n)=>{let i=e(s.Nn);if(!i.authenticated)return;let o=await fetch(`${F.e2.TinyExploreBackendUrl}/admin/unapprove/${n}`,{mode:"cors",cache:"no-store",headers:{"Content-Type":"application/json",Authorization:"Bearer "+i.auth_token},method:"PUT"});if(200!==o.status)throw(await o.json()).message??"Failed to unapprove image.";return!0},[]))}};function W(e){let[t,n]=(0,r.useState)(e.getTime()-Date.now());return(0,r.useEffect)(()=>{let t=setInterval(()=>{n(e.getTime()-Date.now())},1e3);return()=>clearInterval(t)},[e]),[Math.floor(t/864e5),Math.floor(t/36e5%24),Math.floor(t/1e3/60%60),Math.floor(t/1e3%60),Math.floor(t/1e3)]}function G(e){let t=(0,p.B2)(),[n,s,o,a]=W(e.date),l=1===n?t.contest.day:t.contest.days,c=1===s?t.contest.hour:t.contest.hours,d=1===o?t.contest.minute:t.contest.minutes,h=1===a?t.contest.second:t.contest.seconds,[u,x]=(0,r.useState)(!0);return((0,r.useEffect)(()=>{u&&x(!1)},[u]),u)?(0,i.jsx)(i.Fragment,{}):n<=0&&s<=0&&o<=0&&a<=0?(0,i.jsx)("span",{children:e.overString}):(0,i.jsxs)("span",{children:[e.additionalText,0===n?"":`${n} ${l}${t.contest.countdownSeparator}`,0===n&&0===s?"":`${s} ${c}${t.contest.countdownSeparator}`,0===n&&0===s&&0===o?"":`${o} ${d}${t.contest.countdownSeparator}`,a," ",h]})}function q(){let e=(0,p.B2)();return(0,i.jsxs)(V,{children:[(0,i.jsx)(J,{children:(0,i.jsx)("h3",{children:e.contest.imageContestSubmission})}),(0,i.jsxs)(K,{children:[(0,i.jsx)(Q,{children:(0,i.jsx)("p",{children:e.contest.submissionCloses})}),(0,i.jsx)(Z,{}),(0,i.jsx)("div",{style:{padding:20},children:(0,i.jsx)(_,{allowedExtensions:["png"],collection:"nai3yearimage"})})]})]})}function Y(){let e=(0,p.B2)();return(0,i.jsxs)(V,{children:[(0,i.jsx)(J,{children:(0,i.jsx)("h3",{children:e.contest.textContestSubmission})}),(0,i.jsxs)(K,{children:[(0,i.jsxs)(Q,{children:[(0,i.jsx)("p",{children:e.contest.submissionCloses}),(0,i.jsx)(G,{date:new Date("2024-06-25T05:00:00.000Z")})]}),(0,i.jsx)(Q,{children:(0,i.jsx)(X,{})}),(0,i.jsx)("div",{style:{padding:20},children:(0,i.jsx)(_,{allowedExtensions:["png"],collection:"nai3yeartext"})})]})]})}function Z(){let e=(0,p.B2)();return(0,i.jsx)(Q,{children:e.lang===I.TM.jp?(0,i.jsx)(et,{}):(0,i.jsx)(ee,{})})}let J=h.Ay.div.withConfig({componentId:"sc-42b64675-11"})(["padding:20px 20px 0px 20px;display:flex;flex-direction:column;justify-content:flex-end;position:relative;background:",";"],e=>C.F.colors.bg2),K=h.Ay.div.withConfig({componentId:"sc-42b64675-12"})(["background:",";overflow:auto;"],e=>C.F.colors.bg2),Q=h.Ay.div.withConfig({componentId:"sc-42b64675-13"})(["padding:20px;border-bottom:2px solid ",";background:",";"],e=>C.F.colors.bg3,e=>C.F.colors.bg2),V=h.Ay.div.withConfig({componentId:"sc-42b64675-14"})(["width:100%;max-width:min(600px,100vw);border:2px solid ",";background:",";display:flex;flex-direction:column;input,textarea{background:",";color:",";}color:",";h1,h2,h3,h4,h5,h6{color:",";}"],e=>C.F.colors.bg0,e=>C.F.colors.bg2,e=>C.F.colors.bg0,e=>C.F.colors.textMain,e=>C.F.colors.textMain,e=>C.F.colors.textHeadings);function X(){return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("p",{children:["Your story screenshot must be:",(0,i.jsx)("br",{}),"• SFW ",(0,i.jsx)("br",{}),"• Written by the submitter ",(0,i.jsx)("br",{}),"• Related to the Theme"]}),(0,i.jsxs)("p",{children:["Your stories may ",(0,i.jsx)("strong",{children:"not"})," include:",(0,i.jsx)("br",{}),"• Pre-existing IPs of any kind ",(0,i.jsx)("br",{}),"• Overtly sexually explicit content"]})]})}function ee(){return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("p",{children:["Art ",(0,i.jsx)("strong",{children:"must"})," be: ",(0,i.jsx)("br",{}),"• Created by the submitter ",(0,i.jsx)("br",{}),"• Created with a NovelAI Diffusion model of your choice ",(0,i.jsx)("br",{}),"• Related to the Theme (please explain this connection in the description field!)"]}),(0,i.jsxs)("p",{children:["Art may ",(0,i.jsx)("strong",{children:"not"})," include:",(0,i.jsx)("br",{}),"• Pre-existing IPs of any kind ",(0,i.jsx)("br",{}),"• Overtly sexually explicit content"]})]})}function et(){return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("p",{children:["作品の",(0,i.jsx)("strong",{children:"必須条件"}),"：",(0,i.jsx)("br",{}),"• 提出者によって作成されたもの ",(0,i.jsx)("br",{}),"• 選択したNovelAI Diffusionのモデルで作成されたもの",(0,i.jsx)("br",{}),"• テーマに関連したもの（説明欄でその関連性を説明してください！）"]}),(0,i.jsxs)("p",{children:["作品には以下のものは",(0,i.jsx)("strong",{children:"含まない"}),"：",(0,i.jsx)("br",{}),"• あらゆる種類の既存のIP（知的財産） ",(0,i.jsx)("br",{}),"• 露骨に性的なコンテンツ"]})]})}}}]);