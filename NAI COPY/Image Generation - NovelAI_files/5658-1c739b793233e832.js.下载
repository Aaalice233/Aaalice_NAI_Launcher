!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="51dfc6ac-2306-40cf-857c-914d6f20cd3b",e._sentryDebugIdIdentifier="sentry-dbid-51dfc6ac-2306-40cf-857c-914d6f20cd3b")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5658],{35658:(e,t,i)=>{i.d(t,{Ay:()=>T,d7:()=>z});var o=i(94458),l=i(55805),s=i(68658),n=i(51057),d=i(27481),r=i(47644),a=i(81460),c=i(92704),m=i(97223),p=i(41589),u=i(41963),h=i(79630),g=i(73757),x=i(24794),b=i(27524),f=i(89077),j=i(92482),y=i(32139),v=i(71928),w=i(84601),M=i(30769),k=i(300),S=i(88567),I=i(73484),C=i(2834);let L=new j.$6,N=l.Ay.div.withConfig({componentId:"sc-be23c55d-0"})(["flex:1 1 250px;cursor:pointer;position:relative;border:1px solid ",";transition:box-shadow 0.1s ease-in-out,background 0.1s ease-in-out;margin-bottom:10px;&:hover{box-shadow:0 0 5px 2px ",";background:",";}& > div{position:relative;}& > div:nth-child(1){height:130px;display:flex;flex-direction:column;justify-content:flex-end;& > h4{z-index:100;position:relative;padding:0 20px;}&::after{content:'';background:linear-gradient( to bottom,"," 0%,"," 50%,"," 100% );width:100%;height:100%;position:absolute;top:0;left:0;z-index:50;}img{height:120px;object-fit:cover;width:100%;height:100%;position:absolute;top:0;left:0;z-index:50;object-position:center;}}& > div:nth-child(2){padding:10px 15px;font-size:0.9rem;}"],e=>e.theme.colors.bg3,e=>(0,r.No)(.67,e.theme.colors.bg3),e=>(0,r.No)(.67,e.theme.colors.bg3),e=>(0,r.No)(.93,e.theme.colors.bg0),e=>(0,r.No)(.6,e.theme.colors.bg0),e=>(0,r.No)(.27,e.theme.colors.bg0)),B=(0,l.Ay)(N).withConfig({componentId:"sc-be23c55d-1"})(["cursor:pointer;position:relative;border:1px solid ",";transition:box-shadow 0.1s ease-in-out,background 0.1s ease-in-out;min-height:100px;flex:1 1 auto;margin-bottom:0;&:hover{box-shadow:0 0 5px 2px ",";background:",";}& > div{position:relative;}& > div:nth-child(1){display:flex;flex-direction:column;justify-content:flex-end;}"],e=>e.theme.colors.bg3,e=>(0,r.No)(.67,e.theme.colors.bg3),e=>(0,r.No)(.67,e.theme.colors.bg3)),A=l.Ay.div.withConfig({componentId:"sc-be23c55d-2"})(["margin-bottom:15px;& > button:nth-child(1){width:100%;display:flex;flex-direction:row;justify-content:space-between;border-bottom:1px solid ",";padding-bottom:10px;margin-bottom:15px;cursor:pointer;& > div:nth-child(1){display:flex;flex-direction:column;h4{margin-bottom:0;color:",";}}& > div:nth-child(2){display:flex;justify-content:center;align-items:center;}}& > div:nth-child(2){display:grid;grid-template-columns:1fr 1fr 1fr;gap:20px;justify-content:stretch;@media (max-width:800px){grid-template-columns:1fr 1fr;}@media (max-width:500px){grid-template-columns:1fr;}}"],e=>e.theme.colors.bg3,e=>e.theme.colors.textMain),z=(0,l.Ay)(c.Int).withConfig({componentId:"sc-be23c55d-3"})(["opacity:0.9;align-self:center;height:1.5rem;width:1.5rem;mask-size:1rem 1rem;mask-image:url(",");background:",";"],p.A.src,e=>e.theme.colors.textMain),D=l.Ay.div.withConfig({componentId:"sc-be23c55d-4"})(["flex:1 1 250px;display:flex;flex-direction:column;"]),W=l.Ay.div.withConfig({componentId:"sc-be23c55d-5"})(["flex:0 0 auto;padding:5px 5px 0 5px;border:1px solid ",";background:",";border-top:none;"],e=>e.theme.colors.bg3,e=>e.theme.colors.bg1),H=l.Ay.input.withConfig({componentId:"sc-be23c55d-6"})(["margin-bottom:20px;"]);function _(e){let[t,i]=(0,s.useState)(!1),l=L.moduleMatch(e.options,e.filter);return l.length>0?(0,o.jsxs)(A,{children:[(0,o.jsxs)(f.Dp,{onClick:()=>i(!t),children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("h4",{children:e.title}),(0,o.jsx)("div",{children:e.subtitle})]}),(0,o.jsx)("div",{children:t?(0,o.jsx)(c.Kpk,{}):(0,o.jsx)(c.ZLN,{})})]}),(0,o.jsx)("div",{children:!t&&l.map((t,i)=>(0,o.jsxs)(N,{onClick:()=>e.onSelect(t.module.id),onKeyDown:i=>"Enter"===i.key&&e.onSelect(t.module.id),tabIndex:0,"aria-label":t.module.name??"","aria-description":t.module.description??"",role:"button",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)(n.LazyLoadImage,{effect:"opacity",src:t.module.image?.src??""}),(0,o.jsx)("h4",{children:(0,o.jsx)(k.i,{text:t.module.name??"",highlight:t.name})})]}),(0,o.jsx)("div",{children:(0,o.jsx)(k.i,{text:t.module.description,highlight:t.description})})]},i))})]}):(0,o.jsx)(o.Fragment,{})}function F(e){let[t,i]=(0,s.useState)(!1),[l,r]=(0,C.fp)(m.NF),p=(0,C.md)(m.Nn),j=(0,C.md)(m.kt),M=(0,s.useMemo)(()=>{let t=h.C.storyContentCache.get(j);if(!t)return L.moduleMatch(l,e.filter);let i=t?.settings?.model??(0,w.cv)(p.settings,"defaultModel")??y.Lk;return L.moduleMatch(l.filter((0,g.k5)((0,x.Ot)(i))),e.filter)},[l,e.filter,j,p.settings.defaultModel]),I=async e=>{try{await (0,u.c7)(p).deleteModule(e.module),r([...l.filter(t=>t.remoteId!==e.module.remoteId)])}catch(e){(0,v.vV)(e),(0,d.oR)(`${e.message??e}`,{type:"error"})}};return M.length>0?(0,o.jsxs)(A,{children:[(0,o.jsxs)(f.Dp,{onClick:()=>i(!t),children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("h4",{children:e.title}),(0,o.jsx)("div",{children:e.subtitle})]}),(0,o.jsx)("div",{children:t?(0,o.jsx)(c.Kpk,{}):(0,o.jsx)(c.ZLN,{})})]}),(0,o.jsx)("div",{children:!t&&M.map((t,i)=>(0,o.jsxs)(D,{children:[(0,o.jsxs)(B,{onClick:()=>e.onSelect(t.module.id),onKeyDown:i=>"Enter"===i.key&&e.onSelect(t.module.id),tabIndex:0,"aria-label":t.module.name,"aria-description":t.module.description,role:"button",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)(n.LazyLoadImage,{effect:"opacity",src:(0,b.Mj)(t.module.image?.src)?t.module.image?.src:a.TC.src}),(0,o.jsx)("h4",{children:(0,o.jsx)(k.i,{text:t.module.name,highlight:t.name})})]}),(0,o.jsx)("div",{children:(0,o.jsx)(k.i,{text:t.module.description,highlight:t.description})})]}),(0,o.jsx)(W,{children:(0,o.jsx)(S.A,{delay:1,tooltip:"Delete Module",children:(0,o.jsx)(z,{role:"button","aria-label":"Delete Module",onClick:()=>I(t)})})})]},i))})]}):(0,o.jsx)(o.Fragment,{})}function T(e){let t=(0,I.B2)(),[i,l]=(0,s.useState)(""),n=(0,C.md)((0,m.ey)("settings")),d=(0,C.md)(m.NF),{story:r}=(0,M.u)(),c=r?.settings?.model??(0,w.cv)(n,"defaultModel")??y.Lk,p=(0,s.useMemo)(()=>(0,a.I7)(c).map(e=>[e,a.Hl.get(e)]),[c]),u=(0,s.useMemo)(()=>p.filter(e=>e[1].label.startsWith("Theme:")).map(e=>({id:e[0],name:t.modules[e[0]]?.label.replace(/^((theme|style|inspiration|general|special):? *)/i,""),description:t.modules[e[0]]?.description,mode:e[1].mode,image:e[1].image})),[t.modules,p]),h=(0,s.useMemo)(()=>p.filter(e=>e[1].label.startsWith("Style:")).map(e=>({id:e[0],name:t.modules[e[0]]?.label.replace(/^((theme|style|inspiration|general|special):? *)/i,""),description:t.modules[e[0]]?.description,mode:e[1].mode,image:e[1].image})),[t.modules,p]),g=(0,s.useMemo)(()=>p.filter(e=>e[1].label.startsWith("Inspiration:")).map(e=>({id:e[0],name:t.modules[e[0]]?.label.replace(/^((theme|style|inspiration|general|special):? *)/i,""),description:t.modules[e[0]]?.description,mode:e[1].mode,image:e[1].image})),[t.modules,p]),x=(0,s.useMemo)(()=>p.filter(e=>e[1].label.startsWith("Special:")).map(e=>({id:e[0],name:t.modules[e[0]]?.label.replace(/^((theme|style|inspiration|general|special):? *)/i,""),description:t.modules[e[0]]?.description,mode:e[1].mode,image:e[1].image})),[t.modules,p]),b=(0,s.useMemo)(()=>p.filter(e=>e[1].label.startsWith("General:")||"No Module"===e[1].label).map(e=>({id:e[0],name:t.modules[e[0]]?.label.replace(/^((theme|style|inspiration|general|special):? *)/i,""),description:t.modules[e[0]]?.description,mode:e[1].mode,image:e[1].image})),[t.modules,p]),f=(0,s.useMemo)(()=>p.map(e=>({id:e[0],name:e[1].label.replace(/^((theme|style|inspiration|general|special):? *)/i,""),description:e[1].description,mode:e[1].mode,image:e[1].image})),[p]),j=L.moduleMatch(d,i),v=L.moduleMatch(f,i);return(0,o.jsxs)("div",{children:[(0,o.jsx)(H,{placeholder:t.moduleBrowser.searchPlaceholder,type:"text",value:i,onChange:e=>l(e.target.value)}),j.length>0||v.length>0?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(F,{title:t.moduleBrowser.imported,subtitle:t.moduleBrowser.importedSub,onSelect:e.onSelect,filter:i}),(0,o.jsx)(_,{title:t.moduleBrowser.specials,subtitle:t.moduleBrowser.specialsSub,options:x,onSelect:e.onSelect,filter:i}),(0,o.jsx)(_,{title:t.moduleBrowser.general,subtitle:t.moduleBrowser.generalSub,options:b,onSelect:e.onSelect,filter:i}),(0,o.jsx)(_,{title:t.moduleBrowser.style,subtitle:t.moduleBrowser.styleSub,options:h,onSelect:e.onSelect,filter:i}),(0,o.jsx)(_,{title:t.moduleBrowser.theme,subtitle:t.moduleBrowser.themeSub,options:u,onSelect:e.onSelect,filter:i}),(0,o.jsx)(_,{title:t.moduleBrowser.inspiration,subtitle:t.moduleBrowser.inspirationSub,options:g,onSelect:e.onSelect,filter:i})]}):(0,o.jsx)("div",{children:t.moduleBrowser.noModulesFound})]})}},73757:(e,t,i)=>{i.d(t,{YS:()=>b,eR:()=>j,k5:()=>f});var o=i(94458),l=i(68658),s=i(51057),n=i(55805),d=i(32139),r=i(81460),a=i(79630),c=i(97223),m=i(47644),p=i(24794),u=i(27524),h=i(73484),g=i(2834),x=i(51703);let b=n.Ay.div.withConfig({componentId:"sc-f8dd3a1a-0"})(["margin:-5px -10px;position:relative;overflow:hidden;display:block;min-width:200px;max-height:200px;& > div:nth-child(1){position:absolute;left:0;top:0;height:100%;width:100px;img{position:absolute;left:0;top:0;height:100%;width:100px;object-fit:cover;object-position:center;}&::after{content:'';background:linear-gradient( to right,#00000000 0%,"," 90%,"," 100% );left:0;top:0;height:100%;width:100%;position:absolute;}}& > div:nth-child(2){position:relative;margin-left:100px;padding:12px 10px;display:flex;flex-direction:column;justify-content:left;}"],e=>(0,m.No)(.2,e.selected?e.theme.colors.bg0:e.theme.colors.bg2),e=>e.selected?e.theme.colors.bg0:e.theme.colors.bg2);function f(e){return t=>!!e&&(0,p.$p)((0,d.pk)((0,p.Ot)(t.id)),(0,d.pk)(e))}function j(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=(0,h.B2)(),d=(0,g.md)(c.NF),m=(0,x.G)(),j=(0,r.I7)(t??m),y=(0,g.md)(c.kt),v=a.C.storyContentCache.get(y),w=v&&v.settings&&v.settings.aiModule&&!d.some(e=>e.id===v?.settings?.aiModule?.id),M=j.filter(e=>r.Hl.get(e)?.label.startsWith("Theme:")),k=j.filter(e=>r.Hl.get(e)?.label.startsWith("Style:")),S=j.filter(e=>r.Hl.get(e)?.label.startsWith("Inspiration:")),I=j.filter(e=>r.Hl.get(e)?.label.startsWith("Special:")),C=j.filter(e=>r.Hl.get(e)?.label.startsWith("General:")),L=(0,l.useCallback)(t=>({value:t,description:n.modules[t]?.label??t,rawLabel:n.modules[t]?.label??t,label:(0,o.jsxs)(b,{selected:t===e,children:[(0,o.jsx)("div",{children:(0,o.jsx)(s.LazyLoadImage,{effect:"opacity",src:r.Hl.get(t)?.image.src??""})}),(0,o.jsx)("div",{children:(n.modules[t]?.label??t).replace(/^((theme|style|inspiration|general|special|スペシャル|一般|スタイル|テーマ|インスピレーション):? *)/i,"")})]})}),[n.modules,e]),N=(0,l.useMemo)(()=>i&&w&&(0,p.$p)(v?.settings.model,(0,p.Ot)(v?.settings?.aiModule?.id??""))?[{label:"Story",options:[{value:v?.settings?.aiModule?.id,description:v?.settings?.aiModule?.description,rawLabel:v?.settings?.aiModule?.name??n.modules.unknown.label,label:(0,o.jsxs)(b,{selected:v?.settings?.aiModule?.id===e,children:[(0,o.jsx)("div",{children:(0,o.jsx)(s.LazyLoadImage,{effect:"opacity",src:(0,u.Mj)(v?.settings?.aiModule?.image?.src)?v?.settings?.aiModule?.image?.src:r.TC.src})}),(0,o.jsx)("div",{children:v?.settings?.aiModule?.name??n.modules.unknown.label})]})}]}]:[],[i,v?.settings?.aiModule?.description,v?.settings?.aiModule?.id,v?.settings?.aiModule?.image,v?.settings?.aiModule?.name,v?.settings.model,w,n.modules.unknown.label,e]),B=(0,l.useMemo)(()=>[{label:"Imported",options:d.filter(f(t)).map(t=>({value:t.id,description:t.description,rawLabel:t.name,label:(0,o.jsxs)(b,{selected:t.id===e,children:[(0,o.jsx)("div",{children:(0,o.jsx)(s.LazyLoadImage,{effect:"opacity",src:(0,u.Mj)(t.image?.src)?t.image?.src:r.TC.src})}),(0,o.jsx)("div",{children:t.name})]})}))}],[d,t,e]),A=(0,l.useMemo)(()=>[{label:"Specials",options:I.map(e=>L(e))},{label:"General",options:C.map(e=>L(e))},{label:"Styles",options:k.map(e=>L(e))},{label:"Themes",options:M.map(e=>L(e))},{label:"Inspirations",options:S.map(e=>L(e))}],[C,S,L,I,k,M]),z=(0,l.useMemo)(()=>[{label:"Vanilla",options:[L([...r.Hl.keys()][0])]}],[L]);return(0,l.useMemo)(()=>{let e=[];return e.push(...z,...N,...B,...A),e},[A,B,N,z])}}}]);